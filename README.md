# XIV Stats Gatherer (Java) #

[![Build Status](https://mygitlab.org:4043/buildStatus/icon?job=XIVStats-Gatherer-Java)](https://mygitlab.org:4043/job/XIVStats-Gatherer-Java/)
[![Tests Status](https://img.shields.io/jenkins/t/https/mygitlab.org:4043/XIVStats-Gatherer-Java-Tests.svg)](https://mygitlab.org:4043/job/XIVStats-Gatherer-Java-Tests/lastBuild/testReport/)
[![codecov.io](https://codecov.io/github/XIVStats/XIVStats-Gatherer-Java/coverage.svg?branch=master)](https://codecov.io/github/XIVStats/XIVStats-Gatherer-Java?branch=master)

XIVStats Gatherer Java is a multi threaded Java program with the purpose of
fetching a set of character profiles from the
[Final Fantasy XIV Lodestone](http://eu.finalfantasyxiv.com/lodestone/), and
then parse the content of the character profile page before passing it into a
database (MySQL or PostgreSQL).

To see an example of data gathered using this script see
[FFXIVCensus.com](http://ffxivcensus.com/). The database generated by this program
can be used in conjunction with the [XIVStats PHP Script(s)](https://github.com/xivstats/xivstats)
to produce a web page displaying statistics for the data gathered.

## Table of contents
* [Quick start](Quick Start)
* [Bugs and feature requests](Bugs and feature requests)
* [Documentation](Documentation)
* [Contributing](Contributing)
* [XIVStats-Gatherer-Ruby](XIVStats-Gatherer-Ruby)
* [Creators](Creators)
* [Copyright and license](Copyright and license)

## Quick Start
Follow these steps to setup XIVStats-Gatherer-Java:

### 1. Database setup
  1. Setup your own [MySQL](https://dev.mysql.com/doc/refman/5.1/en/installing.html)
   or [PostgreSQL](https://wiki.postgresql.org/wiki/Detailed_installation_guides)
  server instance (if you have not already done so).
  2. Setup a database to store the program data in:
    ```sql  
    CREATE DATABASE dbplayers;
    ```
  3. Create a user for the program to use to connect to the database.

  **Replace {password} with your choice of password, take a note of this for later.**
  ```sql
  GRANT ALL PRIVILEGES ON dbplayers.* TO `xivstats`@`localhost` IDENTIFIED BY '{password}';
  ```

### 2. Program Setup
  1. Install the latest version of either [OpenJDK 8 JRE](http://openjdk.java.net/install/)
  or [Oracle JRE ](http://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html)
  (if you have not already done so).
  2. Download the latest release from the [releases page](https://github.com/XIVStats/XIVStats-Gatherer-Java/releases).
  3. Extract the zip to the directory you wish to install to.
  4. If this is your first time setting up the program - rename the file ```config_example.xml```
  to ```config.xml```.
  5. Open ```config.xml``` in editor of choice.
  6. Configure the options as follows
      * Set the ***url*** parameter to the URL of your SQL server instance, MySQL default: ```mysql://localhost:3306```, PostgreSQL default: ```postgresql://localost:5407```.
      * Set the ***database*** parameter to the database you configured earlier (```dbplayers```).
      * Set the ***username*** parameter to the username you configured earlier (```xivstats```).
      * Set the ***password*** parameter to the password you configured earlier.
      * Set the ***threads*** parameter to the number of threads you want the program to utilize (more threads = faster gatherer crawls). At present there is a safety limit of 64.
  7. Save and close ```config.xml```.
  8. Using a shell (or CMD on windows) run the following command (replace
    {words in brackets} with integer parameters):
  ```shell
  java -jar XIVStats-Gatherer-Java.jar {lowest character id to fetch} {highest character id to fetch}
  ```

  Note: On Linux/Unix it is advised to run the program in Tmux/Screen or similar.

## Bugs and feature requests

If you have discovered a bug, are having issues running the program
(and Google hasn't been any immediate help), or you would like to request a feature
[open an issue over here](https://github.com/XIVStats/XIVStats-Gatherer-Java/issues).

## Documentation
Javadoc documentation for the program can be found [here](http://download.reidweb.com/xivstats/doc/master/index.html).

## Contributing
If you want to contribute to the XIVStats-Gatherer-Java project, please fork this
repository, make the changes you want to make and commit them then
[open a pull request](https://github.com/XIVStats/XIVStats-Gatherer-Java/pulls)
**describing clearly what you are adding**. All feature additions, bug fixes and
other positive contributions are welcome.

All pull requests are subject to contributor review before passing, all build and
test CI stages must also pass before a contribution can be merged.

## XIVStats-Gatherer-Ruby
XIVStats-Gatherer-Java provides the same functionality as the original ruby-based  [XIVStats-Gatherer-Ruby](https://github.com/XIVStats/XIVStats-Gatherer-Ruby),
but is written in Java to make use of Multi-threading capabilities that could
not be harnessed in Ruby. This allows XIVStats-Gatherer-Java to perform large
crawl operations in a much shorter period of time, utilizing only one application
instance. XIVStats-Gatherer-Java also brings with it the benefit of being able
to use a full SQL setup as opposed to a sqlite file, giving the advantage of
being able to perform asynchronous database transactions.

## Creators
**Peter Reid (Project Maintainer)**
* [Website](https://reidweb.com)
* [GitHub](https://github.com/reidweb)

**Jonathan Price (XIVStats and XIVStats-Gatherer-Ruby)**
* [Website](https://jonathanprice.uk)
* [GitHub](https://github.com/pricetx)

## Copyright and license
Code and documentation copyright 2015-2016 Jonathan Price & Peter Reid, Code
and documentation released under the [BSD 2-Clause "Simplified" License](https://github.com/XIVStats/XIVStats-Gatherer-Java/blob/master/LICENSE).
